<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Valuaci√≥n de Propiedades - Aval√∫o Profesional</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        .btn-secondary {
            background: #6b7280;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            margin: 4px;
        }
        .btn-secondary:hover {
            background: #4b5563;
        }
        .card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(229, 231, 235, 1);
            margin-bottom: 20px;
        }
        .input-field {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        .input-field:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        .select-field {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            background: white;
            cursor: pointer;
        }
        .select-field:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        .result-card {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border: 2px solid #3b82f6;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            margin: 10px;
        }
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }
        .grid-4 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .col-span-2 {
            grid-column: span 2;
        }
        .col-span-3 {
            grid-column: span 3;
        }
        @media (max-width: 768px) {
            .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
            }
            .col-span-2, .col-span-3 {
                grid-column: span 1;
            }
        }
        .hidden {
            display: none;
        }
        .text-primary {
            color: #3b82f6;
        }
        .text-green {
            color: #10b981;
        }
        .text-red {
            color: #ef4444;
        }
        .text-blue {
            color: #3b82f6;
        }
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }
        .space-x-4 > * + * {
            margin-left: 1rem;
        }
        .step-indicator {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .step-indicator .step {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .step.active {
            background-color: #3b82f6;
            color: white;
        }
        .step.inactive {
            background-color: #e5e7eb;
            color: #6b7280;
        }
        .tabs {
            border-bottom: 1px solid #e5e7eb;
            margin-bottom: 20px;
        }
        .tab-button {
            padding: 12px 24px;
            border: none;
            background: none;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 500;
            color: #6b7280;
            transition: all 0.3s ease;
        }
        .tab-button.active {
            color: #3b82f6;
            border-bottom-color: #3b82f6;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #374151;
        }
        .form-description {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 8px;
        }
        .badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        .badge-primary {
            background: #dbeafe;
            color: #1d4ed8;
        }
        .badge-green {
            background: #d1fae5;
            color: #059669;
        }
        .summary-card {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            margin-top: 20px;
        }
        .tooltip {
            position: relative;
            cursor: help;
        }
        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #1f2937;
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 8px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .checkbox-item:hover {
            background: #f9fafb;
        }
        .checkbox-item input {
            margin-right: 8px;
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        .comparison-table th {
            background: #f9fafb;
            font-weight: 600;
        }
        .loading-spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Configuraci√≥n de constantes
        const RENTAL_CAP_RATE = 0.05;
        const RENTAL_EXPENSE_RATE = 0.15;

        // Funci√≥n para formatear moneda
        const formatCurrency = (amount, currency = { symbol: '$' }) => {
            return `${currency.symbol}${amount.toLocaleString('en-US', { 
                minimumFractionDigits: 2, 
                maximumFractionDigits: 2 
            })}`;
        };

        // Funci√≥n para calcular factor de tama√±o de terreno
        const getLandSizeFactor = (areaTerreno, topografia, tipoValoracion) => {
            // Factor base seg√∫n el tama√±o del terreno
            let sizeFactor = 1.0;
            
            if (areaTerreno <= 200) {
                sizeFactor = 1.2; // Terrenos peque√±os son m√°s valiosos por m¬≤
            } else if (areaTerreno <= 500) {
                sizeFactor = 1.1;
            } else if (areaTerreno <= 1000) {
                sizeFactor = 1.0;
            } else if (areaTerreno <= 5000) {
                sizeFactor = 0.9;
            } else {
                sizeFactor = 0.8; // Terrenos grandes tienen menor valor por m¬≤
            }

            // Factores de topograf√≠a
            const topographyFactors = {
                'plano': 1.12,
                'pendiente-suave': 1.03,
                'pendiente-moderada': 0.93,
                'pendiente-pronunciada': 0.80,
                'irregular': 0.75
            };

            // Factores por tipo de valoraci√≥n
            const valuationTypeFactors = {
                'residencial': 0.65,
                'comercial': 2.00,
                'industrial': 2.00,
                'agricola': 0.011
            };

            const topographyFactor = topographyFactors[topografia] || 1.0;
            const valuationTypeFactor = valuationTypeFactors[tipoValoracion] || 1.0;

            return sizeFactor * topographyFactor * valuationTypeFactor;
        };

        // Funci√≥n para calcular valuaci√≥n
        const calculatePropertyValuation = (propertyData) => {
            const areaTotal = (propertyData.areaSotano || 0) + 
                             (propertyData.areaPrimerNivel || 0) + 
                             (propertyData.areaSegundoNivel || 0) + 
                             (propertyData.areaTercerNivel || 0) + 
                             (propertyData.areaCuartoNivel || 0);

            let basePrice = 800; // USD por m¬≤ base

            // Factores de ubicaci√≥n (estratos sociales)
            const locationFactors = {
                'estrato-1-elite': 1.50,
                'estrato-2-alto': 1.35,
                'estrato-3-medio-alto': 1.20,
                'estrato-4-medio': 1.00,
                'estrato-5-medio-bajo': 0.85,
                'estrato-6-bajo': 0.70,
                'estrato-7-social': 0.60,
                'estrato-8-marginal': 0.50,
                'excelente': 0.67,
                'buena': 0.66,
                'media': 0.56,
                'regular': 0.49,
                'mala': 0.01
            };

            // Factores de condici√≥n
            const conditionFactors = {
                'nuevo': 1.2,
                'bueno': 1.0,
                'medio': 0.85,
                'regular': 0.7,
                'reparaciones-sencillas': 0.6,
                'reparaciones-medias': 0.5,
                'reparaciones-importantes': 0.4,
                'danos-graves': 0.25,
                'en-desecho': 0.1
            };

            // Factores por tipo de propiedad
            const propertyTypeFactors = {
                'casa': 1.0,
                'departamento': 0.85,
                'terreno': 0.6,
                'comercial': 1.2,
                'bodega': 0.7
            };

            const locationFactor = locationFactors[propertyData.calidadUbicacion] || 1.0;
            const conditionFactor = conditionFactors[propertyData.estadoGeneral] || 1.0;
            const propertyTypeFactor = propertyTypeFactors[propertyData.tipoPropiedad] || 1.0;

            let valorBase;
            
            if (propertyData.tipoPropiedad === 'terreno') {
                const factorTerrenoBase = 0.5;
                const landSizeFactor = getLandSizeFactor(
                    propertyData.areaTerreno, 
                    propertyData.topografia, 
                    propertyData.tipoValoracion
                );
                
                valorBase = propertyData.areaTerreno * basePrice * factorTerrenoBase * 
                           locationFactor * conditionFactor * landSizeFactor;
            } else {
                let areaTotalParaCalculo = areaTotal;
                
                if (propertyData.tipoPropiedad === 'departamento') {
                    areaTotalParaCalculo = areaTotal * 2;
                }
                
                const valorConstruccion = areaTotalParaCalculo * basePrice * propertyTypeFactor * locationFactor * conditionFactor;
                
                let valorTotal = valorConstruccion;
                if (['casa', 'comercial', 'bodega'].includes(propertyData.tipoPropiedad) && propertyData.areaTerreno > 0) {
                    let factorTerreno = 0.4;
                    
                    if (propertyData.tipoPropiedad === 'comercial') {
                        factorTerreno = 0.6;
                    } else if (propertyData.tipoPropiedad === 'bodega') {
                        factorTerreno = 0.3;
                    }
                    
                    const landSizeFactor = getLandSizeFactor(
                        propertyData.areaTerreno, 
                        propertyData.topografia, 
                        propertyData.tipoValoracion
                    );
                    
                    const valorTerreno = propertyData.areaTerreno * basePrice * factorTerreno * 
                                       propertyTypeFactor * locationFactor * conditionFactor * landSizeFactor;
                    
                    valorTotal = valorConstruccion + valorTerreno;
                }
                
                valorBase = valorTotal;
            }

            return Math.round(valorBase);
        };

        // Funci√≥n para generar PDF
        const generatePDF = (propertyData, valuation) => {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            const areaTotal = (propertyData.areaSotano || 0) + 
                             (propertyData.areaPrimerNivel || 0) + 
                             (propertyData.areaSegundoNivel || 0) + 
                             (propertyData.areaTercerNivel || 0) + 
                             (propertyData.areaCuartoNivel || 0);

            // Configuraci√≥n de colores
            const primaryColor = [37, 99, 235];
            const textColor = [51, 51, 51];

            let yPosition = 30;
            const marginLeft = 20;

            // ENCABEZADO
            doc.setFillColor(primaryColor[0], primaryColor[1], primaryColor[2]);
            doc.rect(0, 0, 210, 25, 'F');
            
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(18);
            doc.setFont("helvetica", "bold");
            
            let titleText = 'VALUACI√ìN DE PROPIEDAD';
            if (propertyData.tipoPropiedad === 'casa') {
                titleText = 'VALUACI√ìN RESIDENCIAL';
            } else if (propertyData.tipoPropiedad === 'departamento') {
                titleText = 'VALUACI√ìN DE APARTAMENTO';
            } else if (propertyData.tipoPropiedad === 'terreno') {
                titleText = 'VALUACI√ìN DE TERRENO';
            } else if (propertyData.tipoPropiedad === 'comercial') {
                titleText = 'VALUACI√ìN COMERCIAL';
            }
            
            doc.text(titleText, 105, 15, { align: 'center' });

            yPosition = 40;

            // SECCI√ìN 1: INFORMACI√ìN GENERAL
            doc.setFillColor(245, 245, 245);
            doc.rect(marginLeft - 2, yPosition - 3, 170, 12, 'F');
            
            doc.setFontSize(14);
            doc.setFont("helvetica", "bold");
            doc.setTextColor(primaryColor[0], primaryColor[1], primaryColor[2]);
            doc.text('1. INFORMACI√ìN GENERAL', marginLeft, yPosition + 6);
            
            yPosition += 20;
            
            doc.setFontSize(12);
            doc.setFont("helvetica", "normal");
            doc.setTextColor(textColor[0], textColor[1], textColor[2]);
            
            const generalInfo = [
                `Tipo: ${propertyData.tipoPropiedad}`,
                `√Årea Total Construida: ${areaTotal} m¬≤`,
                `√Årea de Terreno: ${propertyData.areaTerreno} m¬≤`,
                `Estado General de Conservaci√≥n: ${propertyData.estadoGeneral || 'No especificado'}`,
                `Calidad de Ubicaci√≥n: ${propertyData.calidadUbicacion || 'No especificada'}`
            ];

            if (propertyData.tipoPropiedad === 'terreno') {
                generalInfo.push(`Topograf√≠a: ${propertyData.topografia || 'No especificada'}`);
                generalInfo.push(`Tipo de Valoraci√≥n: ${propertyData.tipoValoracion || 'No especificado'}`);
            }

            generalInfo.forEach(info => {
                doc.text(info, marginLeft, yPosition);
                yPosition += 6;
            });

            yPosition += 10;

            // SECCI√ìN 2: UBICACI√ìN
            if (propertyData.direccionCompleta) {
                doc.setFillColor(245, 245, 245);
                doc.rect(marginLeft - 2, yPosition - 3, 170, 12, 'F');
                
                doc.setFontSize(14);
                doc.setFont("helvetica", "bold");
                doc.setTextColor(primaryColor[0], primaryColor[1], primaryColor[2]);
                doc.text('2. UBICACI√ìN DEL INMUEBLE', marginLeft, yPosition + 6);
                
                yPosition += 20;
                
                doc.setFontSize(12);
                doc.setFont("helvetica", "normal");
                doc.setTextColor(textColor[0], textColor[1], textColor[2]);
                
                const lines = doc.splitTextToSize(`Direcci√≥n: ${propertyData.direccionCompleta}`, 170);
                lines.forEach(line => {
                    doc.text(line, marginLeft, yPosition);
                    yPosition += 6;
                });

                if (propertyData.latitud && propertyData.longitud) {
                    doc.text(`Coordenadas: ${propertyData.latitud}, ${propertyData.longitud}`, marginLeft, yPosition);
                    yPosition += 6;
                }

                yPosition += 10;
            }

            // SECCI√ìN 3: √ÅREAS
            doc.setFillColor(245, 245, 245);
            doc.rect(marginLeft - 2, yPosition - 3, 170, 12, 'F');
            
            doc.setFontSize(14);
            doc.setFont("helvetica", "bold");
            doc.setTextColor(primaryColor[0], primaryColor[1], primaryColor[2]);
            doc.text('3. √ÅREAS DE LA PROPIEDAD', marginLeft, yPosition + 6);
            
            yPosition += 20;
            
            doc.setFontSize(12);
            doc.setFont("helvetica", "normal");
            doc.setTextColor(textColor[0], textColor[1], textColor[2]);

            if (propertyData.tipoPropiedad !== 'terreno') {
                const areas = [
                    { name: 'S√≥tano', value: propertyData.areaSotano },
                    { name: 'Primer Nivel', value: propertyData.areaPrimerNivel },
                    { name: 'Segundo Nivel', value: propertyData.areaSegundoNivel },
                    { name: 'Tercer Nivel', value: propertyData.areaTercerNivel },
                    { name: 'Cuarto Nivel', value: propertyData.areaCuartoNivel }
                ];

                areas.forEach(area => {
                    if (area.value && area.value > 0) {
                        doc.text(`${area.name}: ${area.value} m¬≤`, marginLeft, yPosition);
                        yPosition += 6;
                    }
                });

                doc.text(`√Årea Total Construida: ${areaTotal} m¬≤`, marginLeft, yPosition);
                yPosition += 8;
            }

            doc.text(`√Årea de Terreno: ${propertyData.areaTerreno} m¬≤`, marginLeft, yPosition);
            yPosition += 15;

            // SECCI√ìN 4: VALOR ESTIMADO
            doc.setFillColor(245, 245, 245);
            doc.rect(marginLeft - 2, yPosition - 3, 170, 12, 'F');
            
            doc.setFontSize(14);
            doc.setFont("helvetica", "bold");
            doc.setTextColor(primaryColor[0], primaryColor[1], primaryColor[2]);
            doc.text('4. VALOR ESTIMADO', marginLeft, yPosition + 6);
            
            yPosition += 20;
            
            doc.setFontSize(16);
            doc.setFont("helvetica", "bold");
            doc.setTextColor(primaryColor[0], primaryColor[1], primaryColor[2]);
            doc.text(`VALOR ESTIMADO: ${formatCurrency(valuation)}`, marginLeft, yPosition);
            
            yPosition += 15;
            
            // Valores adicionales
            doc.setFontSize(12);
            doc.setFont("helvetica", "bold");
            
            // Alquiler Mensual Estimado
            const alquilerMensual = Math.round((valuation * RENTAL_CAP_RATE / (1 - RENTAL_EXPENSE_RATE)) / 12);
            doc.text(`ALQUILER MENSUAL ESTIMADO: ${formatCurrency(alquilerMensual)}`, marginLeft, yPosition);
            yPosition += 8;
            
            // Valor M√°ximo de Venta
            const valorMaximo = Math.round(valuation * 1.1);
            doc.text(`VALOR M√ÅXIMO DE VENTA: ${formatCurrency(valorMaximo)}`, marginLeft, yPosition);
            yPosition += 8;
            
            // Valor M√≠nimo de Venta
            const valorMinimo = Math.round(valuation * 0.9);
            doc.text(`VALOR M√çNIMO DE VENTA: ${formatCurrency(valorMinimo)}`, marginLeft, yPosition);
            yPosition += 15;
            
            doc.setFontSize(12);
            doc.setFont("helvetica", "normal");
            doc.setTextColor(textColor[0], textColor[1], textColor[2]);
            
            doc.text(`Fecha de valuaci√≥n: ${new Date().toLocaleDateString('es-ES')}`, marginLeft, yPosition);

            // Footer con disclaimer
            doc.setFontSize(8);
            doc.setTextColor(100, 100, 100);
            doc.text('Esta valuaci√≥n es un estimado basado en los datos proporcionados. Se recomienda consultar con un valuador certificado para valuaciones oficiales.', 
                     105, 280, { align: 'center', maxWidth: 170 });

            // Descargar PDF
            doc.save(`valuacion_${propertyData.tipoPropiedad}_${new Date().toISOString().split('T')[0]}.pdf`);
        };

        // Componente principal
        function PropertyValuationApp() {
            const [activeTab, setActiveTab] = useState('areas');
            const [propertyData, setPropertyData] = useState({
                tipoPropiedad: '',
                areaSotano: 0,
                areaPrimerNivel: 0,
                areaSegundoNivel: 0,
                areaTercerNivel: 0,
                areaCuartoNivel: 0,
                areaTerreno: 0,
                estadoGeneral: '',
                calidadUbicacion: '',
                direccionCompleta: '',
                latitud: null,
                longitud: null,
                topografia: '',
                tipoValoracion: '',
                alquiler: 0
            });

            const [valuation, setValuation] = useState(null);
            const [isCalculating, setIsCalculating] = useState(false);
            const [adjustmentPercentage, setAdjustmentPercentage] = useState(0);
            const [finalAdjustedValue, setFinalAdjustedValue] = useState(null);

            const handleInputChange = (field, value) => {
                // Limpiar valor num√©rico
                if (['areaSotano', 'areaPrimerNivel', 'areaSegundoNivel', 'areaTercerNivel', 'areaCuartoNivel', 'areaTerreno', 'alquiler'].includes(field)) {
                    value = value.replace(/[^0-9.]/g, '');
                    value = parseFloat(value) || 0;
                }
                
                setPropertyData(prev => ({
                    ...prev,
                    [field]: value
                }));
            };

            const calculateValuation = () => {
                setIsCalculating(true);
                
                // Simular c√°lculo
                setTimeout(() => {
                    const result = calculatePropertyValuation(propertyData);
                    setValuation(result);
                    setFinalAdjustedValue(result);
                    setIsCalculating(false);
                }, 1500);
            };

            const handleAdjustmentChange = (percentage) => {
                setAdjustmentPercentage(percentage);
                if (valuation) {
                    const adjusted = valuation * (1 + percentage / 100);
                    setFinalAdjustedValue(Math.round(adjusted));
                }
            };

            const isFormValid = () => {
                const areaTotal = (propertyData.areaSotano || 0) + 
                                 (propertyData.areaPrimerNivel || 0) + 
                                 (propertyData.areaSegundoNivel || 0) + 
                                 (propertyData.areaTercerNivel || 0) + 
                                 (propertyData.areaCuartoNivel || 0);

                return propertyData.tipoPropiedad && 
                       propertyData.areaTerreno > 0 && 
                       (propertyData.tipoPropiedad === 'terreno' || areaTotal > 0) &&
                       propertyData.estadoGeneral &&
                       propertyData.calidadUbicacion;
            };

            const startNewValuation = () => {
                setPropertyData({
                    tipoPropiedad: '',
                    areaSotano: 0,
                    areaPrimerNivel: 0,
                    areaSegundoNivel: 0,
                    areaTercerNivel: 0,
                    areaCuartoNivel: 0,
                    areaTerreno: 0,
                    estadoGeneral: '',
                    calidadUbicacion: '',
                    direccionCompleta: '',
                    latitud: null,
                    longitud: null,
                    topografia: '',
                    tipoValoracion: '',
                    alquiler: 0
                });
                setValuation(null);
                setFinalAdjustedValue(null);
                setAdjustmentPercentage(0);
                setActiveTab('areas');
            };

            return (
                <div className="max-w-6xl mx-auto p-6">
                    <div className="text-center mb-8">
                        <h1 className="text-4xl font-bold text-gray-800 mb-2">
                            Sistema de Valuaci√≥n de Propiedades
                        </h1>
                        <p className="text-gray-600">
                            Obt√©n una valuaci√≥n profesional de tu propiedad
                        </p>
                    </div>

                    {/* Navegaci√≥n por pesta√±as */}
                    <div className="tabs">
                        <button 
                            className={`tab-button ${activeTab === 'areas' ? 'active' : ''}`}
                            onClick={() => setActiveTab('areas')}
                        >
                            üìê √Åreas
                        </button>
                        <button 
                            className={`tab-button ${activeTab === 'tipo' ? 'active' : ''}`}
                            onClick={() => setActiveTab('tipo')}
                        >
                            üè† Tipo
                        </button>
                        <button 
                            className={`tab-button ${activeTab === 'caracteristicas' ? 'active' : ''}`}
                            onClick={() => setActiveTab('caracteristicas')}
                        >
                            ‚≠ê Caracter√≠sticas
                        </button>
                        <button 
                            className={`tab-button ${activeTab === 'ubicacion' ? 'active' : ''}`}
                            onClick={() => setActiveTab('ubicacion')}
                        >
                            üìç Ubicaci√≥n
                        </button>
                        <button 
                            className={`tab-button ${activeTab === 'renta' ? 'active' : ''}`}
                            onClick={() => setActiveTab('renta')}
                        >
                            üí∞ M√©todo de Renta
                        </button>
                    </div>

                    {/* Contenido de pesta√±as */}
                    <div className="tab-content">
                        {/* Pesta√±a √Åreas */}
                        <div className={`tab-content ${activeTab === 'areas' ? 'active' : ''}`}>
                            <div className="card">
                                <h2 className="text-2xl font-bold mb-6 text-gray-800">üìê √Åreas de Construcci√≥n</h2>
                                
                                <div className="grid-2">
                                    <div className="form-group">
                                        <label className="form-label">S√≥tano (m¬≤)</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            value={propertyData.areaSotano || ''}
                                            onChange={(e) => handleInputChange('areaSotano', e.target.value)}
                                            placeholder="0"
                                        />
                                    </div>
                                    
                                    <div className="form-group">
                                        <label className="form-label">Primer Nivel (m¬≤)</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            value={propertyData.areaPrimerNivel || ''}
                                            onChange={(e) => handleInputChange('areaPrimerNivel', e.target.value)}
                                            placeholder="0"
                                        />
                                    </div>
                                    
                                    <div className="form-group">
                                        <label className="form-label">Segundo Nivel (m¬≤)</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            value={propertyData.areaSegundoNivel || ''}
                                            onChange={(e) => handleInputChange('areaSegundoNivel', e.target.value)}
                                            placeholder="0"
                                        />
                                    </div>
                                    
                                    <div className="form-group">
                                        <label className="form-label">Tercer Nivel (m¬≤)</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            value={propertyData.areaTercerNivel || ''}
                                            onChange={(e) => handleInputChange('areaTercerNivel', e.target.value)}
                                            placeholder="0"
                                        />
                                    </div>
                                    
                                    <div className="form-group">
                                        <label className="form-label">Cuarto Nivel (m¬≤)</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            value={propertyData.areaCuartoNivel || ''}
                                            onChange={(e) => handleInputChange('areaCuartoNivel', e.target.value)}
                                            placeholder="0"
                                        />
                                    </div>
                                    
                                    <div className="form-group">
                                        <label className="form-label">
                                            √Årea del Terreno (m¬≤) 
                                            <span className="tooltip">‚ÑπÔ∏è
                                                <span className="tooltip-text">
                                                    Para departamentos en niveles superiores, el √°rea de terreno deber√° ser igual al √°rea de construcci√≥n total.
                                                </span>
                                            </span>
                                        </label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            value={propertyData.areaTerreno || ''}
                                            onChange={(e) => handleInputChange('areaTerreno', e.target.value)}
                                            placeholder="0"
                                        />
                                    </div>
                                </div>

                                <div className="summary-card">
                                    <h3 className="font-bold mb-2">Resumen de √Åreas:</h3>
                                    <p>√Årea Total Construida: {
                                        (propertyData.areaSotano || 0) + 
                                        (propertyData.areaPrimerNivel || 0) + 
                                        (propertyData.areaSegundoNivel || 0) + 
                                        (propertyData.areaTercerNivel || 0) + 
                                        (propertyData.areaCuartoNivel || 0)
                                    } m¬≤</p>
                                    <p>√Årea de Terreno: {propertyData.areaTerreno || 0} m¬≤</p>
                                </div>
                            </div>
                        </div>

                        {/* Pesta√±a Tipo */}
                        <div className={`tab-content ${activeTab === 'tipo' ? 'active' : ''}`}>
                            <div className="card">
                                <h2 className="text-2xl font-bold mb-6 text-gray-800">üè† Tipo de Propiedad</h2>
                                
                                <div className="form-group">
                                    <label className="form-label">Selecciona el tipo de propiedad</label>
                                    <select
                                        className="select-field"
                                        value={propertyData.tipoPropiedad}
                                        onChange={(e) => handleInputChange('tipoPropiedad', e.target.value)}
                                    >
                                        <option value="">Seleccionar tipo</option>
                                        <option value="casa">üè† Casa</option>
                                        <option value="departamento">üè¢ Apartamento/Departamento</option>
                                        <option value="terreno">üåø Terreno</option>
                                        <option value="comercial">üè™ Comercial</option>
                                        <option value="bodega">üè≠ Bodega/Industrial</option>
                                    </select>
                                </div>

                                {propertyData.tipoPropiedad && (
                                    <div className="summary-card">
                                        <h3 className="font-bold mb-2">Tipo Seleccionado:</h3>
                                        <span className="badge badge-primary">{propertyData.tipoPropiedad}</span>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Pesta√±a Caracter√≠sticas */}
                        <div className={`tab-content ${activeTab === 'caracteristicas' ? 'active' : ''}`}>
                            <div className="card">
                                <h2 className="text-2xl font-bold mb-6 text-gray-800">‚≠ê Caracter√≠sticas de la Propiedad</h2>
                                
                                <div className="grid-2">
                                    <div className="form-group">
                                        <label className="form-label">Estado General de Conservaci√≥n</label>
                                        <div className="form-description">
                                            Afecta directamente el valor de la propiedad
                                        </div>
                                        <select
                                            className="select-field"
                                            value={propertyData.estadoGeneral}
                                            onChange={(e) => handleInputChange('estadoGeneral', e.target.value)}
                                        >
                                            <option value="">Selecciona el estado de conservaci√≥n</option>
                                            <option value="nuevo">EXCELENTE - Construcci√≥n nueva o reci√©n remodelada</option>
                                            <option value="bueno">BUENA - Conservaci√≥n adecuada, mantenimiento al corriente</option>
                                            <option value="medio">MEDIO - Conservaci√≥n promedio, uso normal visible</option>
                                            <option value="regular">REGULAR - Desgaste visible, necesita mantenimiento</option>
                                            <option value="reparaciones-sencillas">REPARACIONES SENCILLAS - Pintura, detalles menores</option>
                                            <option value="reparaciones-medias">REPARACIONES MEDIAS - Cambio de pisos, plomer√≠a</option>
                                            <option value="reparaciones-importantes">REPARACIONES IMPORTANTES - Estructura, instalaciones</option>
                                            <option value="danos-graves">DA√ëOS GRAVES - Problemas estructurales serios</option>
                                            <option value="en-desecho">EN DESECHO - Demolici√≥n parcial necesaria</option>
                                        </select>
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">
                                            {propertyData.tipoPropiedad === 'terreno' ? 'Factores Ambientales y Riesgos' : 'Calidad de Ubicaci√≥n'}
                                        </label>
                                        <div className="form-description">
                                            {propertyData.tipoPropiedad === 'terreno' ? 
                                                'Eval√∫a riesgos naturales y condiciones ambientales' : 
                                                'Eval√∫a servicios, seguridad, accesibilidad'
                                            }
                                        </div>
                                        <select
                                            className="select-field"
                                            value={propertyData.calidadUbicacion}
                                            onChange={(e) => handleInputChange('calidadUbicacion', e.target.value)}
                                        >
                                            <option value="">Selecciona la calidad de ubicaci√≥n</option>
                                            {propertyData.tipoPropiedad === 'terreno' ? (
                                                <>
                                                    <option value="excelente">Excelente - Sin riesgos naturales, topograf√≠a favorable</option>
                                                    <option value="buena">Buena - Riesgos m√≠nimos, condiciones ambientales aceptables</option>
                                                    <option value="regular">Regular - Algunos riesgos gestionables</option>
                                                    <option value="mala">Deficiente - Alto riesgo de inundaci√≥n, deslizamiento u otros peligros</option>
                                                </>
                                            ) : (
                                                <>
                                                    <option value="estrato-1-elite">Estrato 1 - √âLITE - Zona exclusiva, residencial de lujo</option>
                                                    <option value="estrato-2-alto">Estrato 2 - ALTO - Zona residencial alta, plusval√≠a premium</option>
                                                    <option value="estrato-3-medio-alto">Estrato 3 - MEDIO-ALTO - Zona residencial media-alta</option>
                                                    <option value="estrato-4-medio">Estrato 4 - MEDIO - Zona residencial media, equilibrio precio-valor</option>
                                                    <option value="estrato-5-medio-bajo">Estrato 5 - MEDIO-BAJO - Zona residencial media-baja</option>
                                                    <option value="estrato-6-bajo">Estrato 6 - BAJO - Zona popular, vivienda social</option>
                                                    <option value="estrato-7-social">Estrato 7 - SOCIAL - Zona de inter√©s social</option>
                                                    <option value="estrato-8-marginal">Estrato 8 - MARGINAL - Zona marginal, servicios limitados</option>
                                                </>
                                            )}
                                        </select>
                                    </div>
                                </div>

                                {/* Caracter√≠sticas espec√≠ficas de terreno */}
                                {propertyData.tipoPropiedad === 'terreno' && (
                                    <div className="grid-2">
                                        <div className="form-group">
                                            <label className="form-label">Topograf√≠a</label>
                                            <div className="form-description">
                                                Factores seg√∫n est√°ndares IVS/RICS
                                            </div>
                                            <select
                                                className="select-field"
                                                value={propertyData.topografia}
                                                onChange={(e) => handleInputChange('topografia', e.target.value)}
                                            >
                                                <option value="">Selecciona el tipo de topograf√≠a</option>
                                                <option value="plano">Terreno Plano (0-5% pendiente): +12% - Facilita construcci√≥n</option>
                                                <option value="pendiente-suave">Pendiente Suave (5-15%): +3% - Drenaje natural adecuado</option>
                                                <option value="pendiente-moderada">Pendiente Moderada (15-25%): -7% - Costos adicionales</option>
                                                <option value="pendiente-pronunciada">Pendiente Pronunciada (25-40%): -20% - Requiere ingenier√≠a especializada</option>
                                                <option value="irregular">Terreno Irregular (>40%): -25% - Desarrollo muy costoso</option>
                                            </select>
                                        </div>

                                        <div className="form-group">
                                            <label className="form-label">Tipo de Valoraci√≥n</label>
                                            <div className="form-description">
                                                Factores por uso aplicados seg√∫n est√°ndares internacionales
                                            </div>
                                            <select
                                                className="select-field"
                                                value={propertyData.tipoValoracion}
                                                onChange={(e) => handleInputChange('tipoValoracion', e.target.value)}
                                            >
                                                <option value="">Selecciona el tipo de valoraci√≥n</option>
                                                <option value="residencial">Uso Residencial: -35% - Valor base est√°ndar residencial</option>
                                                <option value="comercial">Uso Comercial: +28% - Mayor potencial de ingresos</option>
                                                <option value="industrial">Uso Industrial: +24% - Infraestructura especializada</option>
                                                <option value="agricola">Uso Agr√≠cola: -57% - Valor extensivo menor</option>
                                            </select>
                                        </div>
                                    </div>
                                )}

                                <div className="summary-card">
                                    <h3 className="font-bold mb-2">Resumen de Caracter√≠sticas:</h3>
                                    <p>Estado General: {propertyData.estadoGeneral || 'No especificado'}</p>
                                    <p>Calidad de Ubicaci√≥n: {propertyData.calidadUbicacion || 'No especificada'}</p>
                                    {propertyData.tipoPropiedad === 'terreno' && (
                                        <>
                                            <p>Topograf√≠a: {propertyData.topografia || 'No especificada'}</p>
                                            <p>Tipo de Valoraci√≥n: {propertyData.tipoValoracion || 'No especificado'}</p>
                                        </>
                                    )}
                                </div>
                            </div>
                        </div>

                        {/* Pesta√±a Ubicaci√≥n */}
                        <div className={`tab-content ${activeTab === 'ubicacion' ? 'active' : ''}`}>
                            <div className="card">
                                <h2 className="text-2xl font-bold mb-6 text-gray-800">üìç Ubicaci√≥n</h2>
                                
                                <div className="grid-2">
                                    <div className="form-group">
                                        <label className="form-label">Direcci√≥n Completa</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            value={propertyData.direccionCompleta || ''}
                                            onChange={(e) => handleInputChange('direccionCompleta', e.target.value)}
                                            placeholder="Ej: Calle 123, Colonia, Ciudad, Estado, CP"
                                        />
                                    </div>
                                    
                                    <div className="form-group">
                                        <label className="form-label">Informaci√≥n adicional (Opcional)</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            placeholder="Referencias, caracter√≠sticas especiales (m√°ximo 500 caracteres)"
                                        />
                                    </div>
                                </div>

                                <div className="grid-2">
                                    <div className="form-group">
                                        <label className="form-label">Latitud</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            value={propertyData.latitud || ''}
                                            onChange={(e) => handleInputChange('latitud', parseFloat(e.target.value) || null)}
                                            placeholder="Ej: 19.4326"
                                        />
                                    </div>
                                    
                                    <div className="form-group">
                                        <label className="form-label">Longitud</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            value={propertyData.longitud || ''}
                                            onChange={(e) => handleInputChange('longitud', parseFloat(e.target.value) || null)}
                                            placeholder="Ej: -99.1332"
                                        />
                                    </div>
                                </div>

                                {propertyData.direccionCompleta && (
                                    <div className="summary-card">
                                        <h3 className="font-bold mb-2">Direcci√≥n Registrada:</h3>
                                        <p>{propertyData.direccionCompleta}</p>
                                        {propertyData.latitud && propertyData.longitud && (
                                            <p>Coordenadas: {propertyData.latitud}, {propertyData.longitud}</p>
                                        )}
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Pesta√±a M√©todo de Renta */}
                        <div className={`tab-content ${activeTab === 'renta' ? 'active' : ''}`}>
                            <div className="card">
                                <h2 className="text-2xl font-bold mb-6 text-gray-800">üí∞ Val√∫o por el M√©todo de la Renta</h2>
                                
                                <div className="form-description mb-4">
                                    Si conoce el alquiler mensual de la propiedad que quiere valuar, por favor escriba el monto
                                </div>
                                
                                <div className="form-group">
                                    <label className="form-label">Monto del Alquiler Mensual</label>
                                    <input
                                        type="text"
                                        className="input-field"
                                        value={propertyData.alquiler || ''}
                                        onChange={(e) => handleInputChange('alquiler', e.target.value)}
                                        placeholder="Ingrese el monto del alquiler mensual"
                                    />
                                </div>

                                {propertyData.alquiler > 0 && (
                                    <div className="summary-card">
                                        <h3 className="font-bold mb-2">Informaci√≥n de Renta:</h3>
                                        <p>Alquiler Mensual: {formatCurrency(propertyData.alquiler)}</p>
                                        <p>Alquiler Anual: {formatCurrency(propertyData.alquiler * 12)}</p>
                                        <p>Valor Estimado por Renta: {formatCurrency((propertyData.alquiler * 12) / RENTAL_CAP_RATE)}</p>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>

                    {/* Bot√≥n de C√°lculo */}
                    <div className="text-center my-8">
                        <button
                            className="btn-primary"
                            onClick={calculateValuation}
                            disabled={!isFormValid() || isCalculating}
                        >
                            {isCalculating ? (
                                <>
                                    <div className="loading-spinner" style={{display: 'inline-block', width: '20px', height: '20px', marginRight: '8px'}}></div>
                                    Calculando Valuaci√≥n...
                                </>
                            ) : (
                                'üßÆ Realizar Valuaci√≥n'
                            )}
                        </button>
                    </div>

                    {/* Resultados de Valuaci√≥n */}
                    {valuation && (
                        <div id="valuation-results" className="card">
                            <h2 className="text-2xl font-bold mb-6 text-gray-800">üìä Resultado de Valuaci√≥n</h2>
                            
                            <div className="grid-3">
                                <div className="result-card">
                                    <h3 className="text-xl font-bold text-blue mb-2">Valor Estimado</h3>
                                    <p className="text-3xl font-bold">{formatCurrency(valuation)}</p>
                                </div>
                                
                                <div className="result-card">
                                    <h3 className="text-xl font-bold text-green mb-2">Alquiler Mensual</h3>
                                    <p className="text-2xl font-bold">
                                        {formatCurrency(Math.round((valuation * RENTAL_CAP_RATE / (1 - RENTAL_EXPENSE_RATE)) / 12))}
                                    </p>
                                </div>
                                
                                <div className="result-card">
                                    <h3 className="text-xl font-bold text-primary mb-2">Rango de Venta</h3>
                                    <p className="text-lg">
                                        Min: {formatCurrency(Math.round(valuation * 0.9))}<br/>
                                        Max: {formatCurrency(Math.round(valuation * 1.1))}
                                    </p>
                                </div>
                            </div>

                            {/* Ajuste de Precio */}
                            <div className="card">
                                <h3 className="text-xl font-bold mb-4">‚öñÔ∏è Ajuste de Precio</h3>
                                <div className="form-description mb-4">
                                    Ajusta el precio final basado en factores adicionales
                                </div>
                                
                                <div className="grid-2">
                                    <div className="form-group">
                                        <label className="form-label">Porcentaje de Ajuste (%)</label>
                                        <input
                                            type="range"
                                            min="-30"
                                            max="30"
                                            value={adjustmentPercentage}
                                            onChange={(e) => handleAdjustmentChange(parseFloat(e.target.value))}
                                            className="input-field"
                                        />
                                        <div className="text-center mt-2">
                                            <span className={adjustmentPercentage >= 0 ? 'text-green' : 'text-red'}>
                                                {adjustmentPercentage > 0 ? '+' : ''}{adjustmentPercentage}%
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <div className="form-group">
                                        <label className="form-label">Valor Ajustado</label>
                                        <div className="result-card">
                                            <p className="text-2xl font-bold">
                                                {formatCurrency(finalAdjustedValue)}
                                            </p>
                                            {adjustmentPercentage !== 0 && (
                                                <p className="text-sm">
                                                    Ajuste: {formatCurrency(finalAdjustedValue - valuation)}
                                                </p>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* Botones de Acci√≥n */}
                            <div className="text-center space-x-4">
                                <button
                                    className="btn-primary"
                                    onClick={() => generatePDF(propertyData, finalAdjustedValue || valuation)}
                                >
                                    üìÑ Descargar PDF
                                </button>
                                <button
                                    className="btn-secondary"
                                    onClick={startNewValuation}
                                >
                                    üîÑ Nueva Valuaci√≥n
                                </button>
                            </div>
                        </div>
                    )}

                    {/* Footer */}
                    <div className="text-center mt-8 text-gray-500 text-sm">
                        <p>Esta valuaci√≥n es un estimado basado en los datos proporcionados.</p>
                        <p>Se recomienda consultar con un valuador certificado para valuaciones oficiales.</p>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<PropertyValuationApp />, document.getElementById('root'));
    </script>
</body>
</html>